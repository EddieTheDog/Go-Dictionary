<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Go Dictionary Admin</title>
<style>
    body { font-family: Arial, sans-serif; padding: 2em; max-width: 400px; margin:auto; }
    button, input, textarea { width: 100%; margin: 0.5em 0; padding: 0.7em; font-size: 1em; border-radius: 8px; border: 1px solid #ccc; }
    button { background: #4CAF50; color: white; border: none; cursor: pointer; }
    button:hover { background: #45a049; }
</style>
</head>
<body>
<h1>Admin Dashboard</h1>

<h2>Commands</h2>
<button id="clearLocal">Clear Local Storage</button>
<button id="clearCookies">Clear Cookies</button>
<button id="showInstructions">Show Instructions Page</button>
<button id="reloadPage">Reload Page for All Users</button>
<button id="triggerCustom">Trigger Custom Function</button>

<h2>Send Announcement</h2>
<textarea id="announcementMessage" placeholder="Type your announcement here"></textarea>
<button id="sendAnnouncementBtn">Send Announcement</button>

<!-- Socket.io CDN (removed integrity) -->
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // Make sure Socket.io loaded
    if (typeof io === 'undefined') {
        console.error('Socket.io failed to load. Admin commands will not work.');
        return;
    }

    const socket = io();

    // Command functions
    function sendCommand(command) {
        socket.emit('admin-command', command);
        console.log('Sent command:', command);
    }

    function sendAnnouncement(message) {
        if (!message) return;
        socket.emit('admin-announcement', message);
        alert('Announcement sent!');
    }

    // Attach buttons
    document.getElementById('clearLocal').addEventListener('click', () => sendCommand('clear-local-storage'));
    document.getElementById('clearCookies').addEventListener('click', () => sendCommand('clear-cookies'));
    document.getElementById('showInstructions').addEventListener('click', () => sendCommand('show-instructions'));
    document.getElementById('reloadPage').addEventListener('click', () => sendCommand('reload-page'));
    document.getElementById('triggerCustom').addEventListener('click', () => sendCommand('trigger-custom'));

    document.getElementById('sendAnnouncementBtn').addEventListener('click', () => {
        const msg = document.getElementById('announcementMessage').value.trim();
        sendAnnouncement(msg);
        document.getElementById('announcementMessage').value = '';
    });
});
</script>
</body>
</html>
